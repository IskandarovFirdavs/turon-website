{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Home page" %}{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'admin/css/styles/home.css' %}">
<style>
    .gallery-preview-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 15px;
        margin-top: 20px;
    }

    .gallery-preview-item {
        position: relative;
        height: 180px;
        overflow: hidden;
        border-radius: 8px;
        cursor: pointer;
    }

    .gallery-preview-item img,
    .gallery-preview-item video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .gallery-preview-item:hover img,
    .gallery-preview-item:hover video {
        transform: scale(1.05);
    }

    .gallery-preview-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0,0,0,0.7));
        color: white;
        padding: 10px;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .gallery-preview-item:hover .gallery-preview-overlay {
        opacity: 1;
    }

    .video-indicator {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0,0,0,0.7);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
    }

    @media (max-width: 992px) {
        .gallery-preview-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    @media (max-width: 768px) {
        .gallery-preview-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 480px) {
        .gallery-preview-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}
{% block content %}
<main>
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-pattern">
            <img src="{% static 'admin/img/naqsh.jpg' %}" alt="">
        </div>
        <div class="hero-container">
            <div class="hero-content">
                <h1 class="hero-title">{% trans "Xalqaro Turon federatsiyasiga xush kelibsiz" %}</h1>
                <p class="hero-subtitle">{% trans "Turon an'anaviy sport turlarini butun dunyoda saqlash va targ'ib qilish" %}</p>

                <div class="hero-stats">
                    <div class="hero-stat">
                        <span class="hero-stat-number">15+</span>
                        <span class="hero-stat-label">{% trans "A'zo davlatlar" %}</span>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-number">500+</span>
                        <span class="hero-stat-label">{% trans "Sportchilar" %}</span>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-number">25+</span>
                        <span class="hero-stat-label">{% trans "Yillik tadbirlar" %}</span>
                    </div>
                </div>

                <div class="hero-buttons">
                    <a href="{% url 'about' %}" class="btn btn-primary">{% trans "Batafsil ma'lumot oling" %}</a>
                    <a href="{% url 'events' %}" class="btn btn-primary">{% trans "Tadbirlarni ko'rish" %}</a>
                </div>
            </div>
        </div>
        <div class="heroo-pattern">
            <img src="{% static 'admin/img/naqsh.jpg' %}" alt="">
        </div>
    </section>

    <!-- Welcome Section -->
    <section class="welcome-section">
        <div class="container">
            <h2 class="welcome-title">{% trans "Turon federatsiya saytiga xush kelibsiz" %}</h2>
            <p>{% trans "Madaniy meros va sport mahorati orqali anʼanaviy Turon sport turlarini saqlash va targʻib qilish." %}</p>
        </div>
    </section>

    <!-- News Section -->
    <section class="news-section">
        <div class="container">
            <h2 class="section-title">{% trans "So'ngi yangiliklar" %}</h2>
            <div class="news-grid">
                {% for item in news %}
                <article class="news-card">
                    {% if item.main_image %}
                        <img src="{{ item.main_image.url }}" alt="{{ item.title }}">
                    {% endif %}
                    <div class="news-card-content">
                        <h3 class="news-card-title">{{ item.title }}</h3>
                        <p class="news-card-excerpt">{{ item.text|truncatewords:20 }}</p>
                        <time class="news-card-date">{{ item.date|date:"d M Y" }}</time><br><br>
                        <a href="{% url 'news_detail' item.pk %}" class="btn btn-secondary">{% trans "Batafsil" %}</a>
                    </div>
                </article>
                {% empty %}
                <p style="text-align: center; color: #6b7280;">{% trans "Yangiliklar mavjud emas." %}</p>
                {% endfor %}
            </div>
            {% if news %}
            <div style="text-align: center; margin-top: 20px;">
                <a href="{% url 'news' %}" class="btn btn-primary">{% trans "Barcha yangiliklar" %}</a>
            </div>
            {% endif %}
        </div>
    </section>

    <!-- About Preview -->
    <section class="about-preview">
        <div class="container">
            <div class="about-content">
                <div class="about-text">
                    <h2>{% trans "Turon federatsiyasi haqida" %}</h2>
                    <p>{% trans "Xalqaro 'Turon' federatsiyasi anʼanaviylikni asrab-avaylash va targʻib qilishga bagʻishlangan Markaziy Osiyo sporti." %}</p>
                    <a href="{% url 'about' %}" class="btn btn-primary">{% trans "Batafsil ma'lumot" %}</a>
                </div>

                <div class="about-image">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSEYJLIdxp4fCQEQyEYOvMCIzM3hFtlxC-G_A&s" alt="Traditional Sports">
                </div>
            </div>
        </div>
    </section>

    <!-- Events Section -->
    <section class="events-section">
        <div class="container">
            <h2 class="section-title">{% trans "Yaqin tadbirlar" %}</h2>
            <div class="news-grid">
                {% for event in events %}
                <article class="news-card">
                    {% if event.main_image %}
                        <img src="{{ event.main_image.url }}" alt="{{ event.title }}">
                    {% endif %}
                    <div class="news-card-content">
                        <h3 class="news-card-title">{{ event.title }}</h3>
                        <p class="news-card-excerpt">{{ event.description|truncatewords:15 }}</p>
                        <time class="news-card-date">{{ event.date|date:"d M Y" }}</time>
                        <a href="{% url 'event_detail' event.pk %}" class="btn btn-secondary">{% trans "Batafsil" %}</a>
                    </div>
                </article>
                {% empty %}
                <p style="text-align: center; color: #6b7280;">{% trans "Tadbirlar mavjud emas." %}</p>
                {% endfor %}
            </div>
            {% if events %}
            <div style="text-align: center; margin-top: 20px;">
                <a href="{% url 'events' %}" class="btn btn-primary">{% trans "Barcha tadbirlar" %}</a>
            </div>
            {% endif %}
        </div>
    </section>

    <!-- Gallery Preview -->
    <section class="gallery-preview">
        <div class="container">
            <h2 class="section-title">{% trans "Galereya" %}</h2>

            <div class="gallery-preview-grid">
                {% for image in images|slice:":8" %}
                <div class="gallery-preview-item">
                    <img src="{{ image.image.url }}" alt="Gallery image">
                    <div class="gallery-preview-overlay">
                        <p>{{ image.news.title|default:"Rasm"|truncatewords:3 }}</p>
                    </div>
                </div>
                {% endfor %}

                {% for video in videos|slice:":4" %}
                <div class="gallery-preview-item">
                    <video muted loop>
                        <source src="{{ video.video.url }}" type="video/mp4">
                    </video>
                    <div class="video-indicator">{% trans "Video" %}</div>
                    <div class="gallery-preview-overlay">
                        <p>{{ video.news.title|default:"Video"|truncatewords:3 }}</p>
                    </div>
                </div>
                {% endfor %}

                {% if not images and not videos %}
                <p style="text-align: center; color: #6b7280; grid-column: 1 / -1;">
                    {% trans "Galereyada hozircha hech narsa mavjud emas." %}
                </p>
                {% endif %}
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <a href="{% url 'gallery' %}" class="btn btn-primary">{% trans "Barchasini ko'rish" %}</a>
            </div>
        </div>
    </section>

    <!-- Partners Section -->
    <section class="partners-section">
        <div class="container">
            <h2 class="section-title">{% trans "Azolar" %}</h2>
            <div class="news-grid">
                {% for member in members %}
                <article class="news-card">
                    <a href="{{ member.website_url }}" target="_blank">
                        <img src="{{ member.image.url }}" alt="{{ member.name }}" style="height: 150px; object-fit: contain;">
                        <div style="text-align: center; margin-top: 10px;">
                            <h3>{{ member.name }}</h3>
                        </div>
                    </a>
                </article>
                {% empty %}
                <p style="text-align: center; color: #6b7280;">{% trans "A'zolar mavjud emas." %}</p>
                {% endfor %}
            </div>
        </div>
    </section>
</main>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Video play on hover in gallery preview
    const videoItems = document.querySelectorAll('.gallery-preview-item video');

    videoItems.forEach(video => {
        const galleryItem = video.closest('.gallery-preview-item');

        galleryItem.addEventListener('mouseenter', function() {
            video.play().catch(e => console.log("Autoplay prevented:", e));
        });

        galleryItem.addEventListener('mouseleave', function() {
            video.pause();
            video.currentTime = 0;
        });
    });
});
</script>
{% endblock %}